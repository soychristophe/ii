<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Configuración: Pausa Antes de Subtítulo</title>
  <script>
    // Script para asegurar que el checkbox se guarde correctamente
    window.addEventListener('DOMContentLoaded', () => {
      const checkbox = document.querySelector('input[data-pref-key="autoRepeatEnabled"]');
      if (checkbox && window.iina && window.iina.preferences) {
        // Cargar valor guardado
        window.iina.preferences.get('autoRepeatEnabled', (value) => {
          console.log('Cargando autoRepeatEnabled desde HTML:', value, typeof value);
          if (value === true || value === 'true' || value === '1' || value === 1) {
            checkbox.checked = true;
          } else {
            checkbox.checked = false;
          }
        });
        
        // Guardar al cambiar
        checkbox.addEventListener('change', () => {
          const newValue = checkbox.checked;
          console.log('Guardando autoRepeatEnabled desde HTML:', newValue);
          window.iina.preferences.set('autoRepeatEnabled', newValue);
        });
      }
    });
  </script>
</head>
<body>
  <div class="pref-section">
    <label>Margen de pausa (segundos):</label>
    <input type="number" data-pref-key="pauseMargin" data-type="float" min="-5.0" max="5.0" step="0.1" />
    <p class="small secondary pref-help">Cuántos segundos antes del fin pausar.</p>
  </div>
  
  <div class="pref-section">
    <label>Intervalo de chequeo (ms):</label>
    <input type="number" data-pref-key="checkIntervalMs" data-type="int" min="50" max="500" step="50" />
    <p class="small secondary pref-help">Frecuencia durante el subtítulo (menor = más preciso).</p>
  </div>
  
  <div class="pref-section">
    <label>Intervalo de polling (ms):</label>
    <input type="number" data-pref-key="pollIntervalMs" data-type="int" min="100" max="1000" step="50" />
    <p class="small secondary pref-help">Frecuencia para detectar nuevos subtítulos.</p>
  </div>

  <div class="pref-section">
    <label>Compensación de tiempo (segundos):</label>
    <input type="number" data-pref-key="timeOffset" data-type="float" min="-1.0" max="1.0" step="0.1" />
    <p class="small secondary pref-help">Ajuste para desfases (negativo si pausa antes, positivo si después).</p>
  </div>

  <div class="pref-section">
    <label>
      <input type="checkbox" data-pref-key="autoRepeatEnabled" data-type="bool" />
      Activar Auto-Repetición
    </label>
    <p class="small secondary pref-help">Repite automáticamente cada subtítulo el número de veces especificado. <strong>Usa la tecla R si esta opción no funciona desde aquí.</strong></p>
  </div>

  <div class="pref-section">
    <label>Número de repeticiones:</label>
    <input type="number" data-pref-key="autoRepeatTimes" data-type="int" min="1" max="10" step="1" />
    <p class="small secondary pref-help">Cuántas veces repetir cada subtítulo (mínimo 1, máximo 10).</p>
  </div>
</body>
</html>